<div class="dashboard-container">
  @if (loading) {
    <p>Loading user profile...</p>
  } @else if (userProfile) {
    <div class="profile-section">
      <h2>Welcome, {{ firstname | titlecase}}</h2>
    </div>
    <div class="card-container">
      <div class="card">
        <h3>Total Income</h3>
        <p>{{ userProfile.income | currency:'INR' }}</p>
      </div>
      <div class="card">
        <h3>Total Savings</h3>
        <p>{{ userProfile.savings | currency:'INR' }}</p>
      </div>
      <div class="card">
        <h3>Target Expenses</h3>
        <p>{{ userProfile.targetExpenses | currency:'INR' }}</p>
      </div>
    </div>
  }

  @if (isFormVisible) {
    <div class="modal">
      <div class="modal-content">
        <span class="close" (click)="isFormVisible = false">&times;</span>
        <app-transaction-form
          [prefilledCategory]="prefilledCategory"
          (transactionAdded)="onTransactionAdded($event)"
          (closeForm)="isFormVisible = false">
        </app-transaction-form>
      </div>
    </div>
  }

  <div class="transactions-section">
    <div class="transactions-header">
      <h3>Recent Transactions</h3>
      <button (click)="onAddTransaction()">Add New Transaction</button>
    </div>
    <app-transactions-list
      [transactions]="transactions"
      (transactionUpdated)="refreshAllData()"
      (transactionDeleted)="refreshAllData()">
    </app-transactions-list>
  </div>

  <div class="dashboard-bottom-sections">
    <div class="section-half">
      <app-budget-tracker #budgetTracker (addTransactionForCategory)="onAddTransactionForCategory($event)"></app-budget-tracker>
    </div>
    <div class="section-half">
      <app-saving-goals
        #savingGoalsTracker
        (goalUpdated)="refreshAllData()"
        (goalDeleted)="refreshAllData()">
      </app-saving-goals>
    </div>
  </div>
</div>
